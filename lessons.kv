#:import day_times lessons.day_times
#:import week_days lessons.week_days
#:import week_types lessons.week_types
#:import lesson_types lessons.lesson_types
#:import teacher_list database.teacher_list
#:import group_list database.group_list
#:import room_list database.room_list

<Lesson>:
    font_size: self.height / (self.lines + 3)
    # Define the properties for the drag
    drag_rectangle: self.x, self.y, self.width, self.height
    drag_timeout: 1000
    drag_distance: 0

    markup: True

<LessonPopup>:
    size_hint: .5, .5
    title: 'Editing lesson'
    auto_dismiss: False
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            Label:
                text: _('Group')
                size_hint_x: 0.3
            ChoiceInput:
                text: ', '.join(root.lesson.groups)
                choices: group_list
                size_hint_x: 0.7
        BoxLayout:
            Label:
                text: _('Teacher')
                size_hint_x: 0.3
            ChoiceInput:
                text: root.lesson.teacher
                choices: teacher_list
                size_hint_x: 0.7
        BoxLayout:
            size_hint_y: 2
            Label:
                text: _('Lesson')
                size_hint_x: 0.3
            ChoiceInput:
                text: root.lesson.lesson
                size_hint_x: 0.7
        BoxLayout:
            Label:
                text: _('Room')
                size_hint_x: 0.3
            ChoiceInput:
                text: _('Group')
                choices: lesson_types.values()
                size_hint_x: 0.35
            ChoiceInput:
                text: root.lesson.room
                choices: room_list
                size_hint_x: 0.35
        BoxLayout:
            ToggleButton:
                text: week_types['upper']
                size_hint_x: 0.15
                state: 'down' if root.lesson.week == 'upper' else 'normal'
            ToggleButton:
                text: week_types['lower']
                size_hint_x: 0.15
                state: 'down' if root.lesson.week == 'lower' else 'normal'
            ChoiceInput:
                text: week_days[root.lesson.day]
                choices: week_days
                size_hint_x: 0.35
            ChoiceInput:
                text: day_times[root.lesson.number]
                size_hint_x: 0.35
                choices: day_times
        BoxLayout:
            Button:
                text: _('Dismiss')
                on_release: root.dismiss()
            Button:
                text: _('Accept')
                # on_press: root.update(root.lesson, root.new_lesson)
                on_release: root.dismiss()
